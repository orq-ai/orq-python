"""Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT."""

from __future__ import annotations
from .datapart import DataPart, DataPartTypedDict
from .errorpart import ErrorPart, ErrorPartTypedDict
from .filepart import FilePart, FilePartTypedDict
from .textpart import TextPart, TextPartTypedDict
from .toolcallpart import ToolCallPart, ToolCallPartTypedDict
from .toolresultpart import ToolResultPart, ToolResultPartTypedDict
from orq_ai_sdk.types import BaseModel, UNSET_SENTINEL
from orq_ai_sdk.utils import get_discriminator
import pydantic
from pydantic import Discriminator, Tag, model_serializer
from typing import Any, Dict, List, Literal, Optional, Union
from typing_extensions import Annotated, NotRequired, TypeAliasType, TypedDict


Role = Literal[
    "user",
    "agent",
    "tool",
    "system",
]


PartsTypedDict = TypeAliasType(
    "PartsTypedDict",
    Union[
        TextPartTypedDict,
        ErrorPartTypedDict,
        DataPartTypedDict,
        FilePartTypedDict,
        ToolResultPartTypedDict,
        ToolCallPartTypedDict,
    ],
)


Parts = Annotated[
    Union[
        Annotated[TextPart, Tag("text")],
        Annotated[ErrorPart, Tag("error")],
        Annotated[DataPart, Tag("data")],
        Annotated[FilePart, Tag("file")],
        Annotated[ToolCallPart, Tag("tool_call")],
        Annotated[ToolResultPart, Tag("tool_result")],
    ],
    Discriminator(lambda m: get_discriminator(m, "kind", "kind")),
]


class AgentResponseMessageTypedDict(TypedDict):
    r"""Response message from an agent execution."""

    message_id: str
    role: Role
    parts: List[PartsTypedDict]
    metadata: NotRequired[Dict[str, Any]]


class AgentResponseMessage(BaseModel):
    r"""Response message from an agent execution."""

    message_id: Annotated[str, pydantic.Field(alias="messageId")]

    role: Role

    parts: List[Parts]

    metadata: Optional[Dict[str, Any]] = None

    @model_serializer(mode="wrap")
    def serialize_model(self, handler):
        optional_fields = set(["metadata"])
        serialized = handler(self)
        m = {}

        for n, f in type(self).model_fields.items():
            k = f.alias or n
            val = serialized.get(k)

            if val != UNSET_SENTINEL:
                if val is not None or k not in optional_fields:
                    m[k] = val

        return m


try:
    AgentResponseMessage.model_rebuild()
except NameError:
    pass
