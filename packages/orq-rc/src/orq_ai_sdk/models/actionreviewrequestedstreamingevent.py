"""Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT."""

from __future__ import annotations
from orq_ai_sdk.types import BaseModel, UNSET_SENTINEL
import pydantic
from pydantic import model_serializer
from typing import Any, Dict, List, Literal, Optional
from typing_extensions import Annotated, NotRequired, TypedDict


ActionReviewRequestedStreamingEventType = Literal[
    "event.agents.action_review_requested",
]


class ConditionsTypedDict(TypedDict):
    condition: str
    r"""The argument of the tool call to evaluate"""
    operator: str
    r"""The operator to use"""
    value: str
    r"""The value to compare against"""


class Conditions(BaseModel):
    condition: str
    r"""The argument of the tool call to evaluate"""

    operator: str
    r"""The operator to use"""

    value: str
    r"""The value to compare against"""


class ToolTypedDict(TypedDict):
    id: str
    r"""The id of the resource"""
    action_type: str
    key: NotRequired[str]
    r"""Optional tool key for custom tools"""
    display_name: NotRequired[str]
    description: NotRequired[str]
    r"""Optional tool description"""
    requires_approval: NotRequired[bool]
    tool_id: NotRequired[str]
    r"""Nested tool ID for MCP tools (identifies specific tool within MCP server)"""
    conditions: NotRequired[List[ConditionsTypedDict]]
    timeout: NotRequired[float]
    r"""Tool execution timeout in seconds (default: 2 minutes, max: 10 minutes)"""


class Tool(BaseModel):
    id: str
    r"""The id of the resource"""

    action_type: str

    key: Optional[str] = None
    r"""Optional tool key for custom tools"""

    display_name: Optional[str] = None

    description: Optional[str] = None
    r"""Optional tool description"""

    requires_approval: Optional[bool] = False

    tool_id: Optional[str] = None
    r"""Nested tool ID for MCP tools (identifies specific tool within MCP server)"""

    conditions: Optional[List[Conditions]] = None

    timeout: Optional[float] = 120
    r"""Tool execution timeout in seconds (default: 2 minutes, max: 10 minutes)"""

    @model_serializer(mode="wrap")
    def serialize_model(self, handler):
        optional_fields = set(
            [
                "key",
                "display_name",
                "description",
                "requires_approval",
                "tool_id",
                "conditions",
                "timeout",
            ]
        )
        serialized = handler(self)
        m = {}

        for n, f in type(self).model_fields.items():
            k = f.alias or n
            val = serialized.get(k)

            if val != UNSET_SENTINEL:
                if val is not None or k not in optional_fields:
                    m[k] = val

        return m


class ActionReviewRequestedStreamingEventDataTypedDict(TypedDict):
    agent_id: str
    action_id: str
    requires_approval: bool
    tool: ToolTypedDict
    input: Dict[str, Any]
    agent_tool_call_id: str
    response_id: NotRequired[str]


class ActionReviewRequestedStreamingEventData(BaseModel):
    agent_id: str

    action_id: str

    requires_approval: bool

    tool: Tool

    input: Dict[str, Any]

    agent_tool_call_id: str

    response_id: Annotated[Optional[str], pydantic.Field(alias="responseId")] = None

    @model_serializer(mode="wrap")
    def serialize_model(self, handler):
        optional_fields = set(["responseId"])
        serialized = handler(self)
        m = {}

        for n, f in type(self).model_fields.items():
            k = f.alias or n
            val = serialized.get(k)

            if val != UNSET_SENTINEL:
                if val is not None or k not in optional_fields:
                    m[k] = val

        return m


class ActionReviewRequestedStreamingEventTypedDict(TypedDict):
    r"""Emitted when a tool action requires approval before execution. Contains the tool details, input arguments, and whether approval is mandatory."""

    type: ActionReviewRequestedStreamingEventType
    timestamp: str
    r"""ISO timestamp of the event"""
    data: ActionReviewRequestedStreamingEventDataTypedDict


class ActionReviewRequestedStreamingEvent(BaseModel):
    r"""Emitted when a tool action requires approval before execution. Contains the tool details, input arguments, and whether approval is mandatory."""

    type: ActionReviewRequestedStreamingEventType

    timestamp: str
    r"""ISO timestamp of the event"""

    data: ActionReviewRequestedStreamingEventData
